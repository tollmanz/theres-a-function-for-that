<!DOCTYPE html>

<!--
  Google HTML5 slide template

  Authors: Luke MahÃ© (code)
           Marcin Wichary (code and design)
           
           Dominic Mazzoni (browser compatibility)
           Charles Chen (ChromeVox support)

  URL: http://code.google.com/p/html5slides/
-->

<html>
	<head>
		<title>There's a Function for That | Doing More for Less with Core Functions</title>

		<meta charset='utf-8'>
        <link href="fonts.css" type="text/css" rel="stylesheet" media="all">
		<script src='slides.js'></script>
	</head>

<body style='display: none;'>

	<section class='slides layout-regular template-default'>

        <article>

            <h1>There's a Function for That: Doing More for Less With Core Functions</h1>

            <p>
                Zack Tollman, 10up LLC<br>
                @tollmanz<br>
                10up.com
            </p>

        </article>

        <article>

            <h2>Gameplan</h2>

            <p>Propaganda</p>
            <p>Functions</p>
            <ul>
                <li>Function Definition</li>
                <li>Real World Example</li>
            </ul>

        </article>

        <article>

            <h2>Propaganda</h2>

            <p>Use Core Functions</p>

            <ul>
                <li>Less Overhead</li>
                <li>More Stable</li>
                <li>Easier to Read/Extend/Contribute To</li>
            </ul>

        </article>

        <article class="transition">
            <p>I need a function that will help me select the initial option for a select tag.</p>
        </article>

        <article>

            <h3>selected</h3>

            <h4>Purpose</h4>
            <p>Add "selected" attribute to an option tag</p>

            <h4>Args</h4>
            <ul>
                <li>$checked [mixed] value to match against $current</li>
                <li>$current [mixed] value to match against $checked; default = (bool) true</li>
                <li>$echo [bool] true to echo; false to return; default = (bool) true</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[string] 'selected="selected"' or empty string</li>
            </ul>

        </article>

        <article>

            <h3>selected</h3>

            <h4>Example</h4>

            <p>Aaron Campbell - Twitter Widget Pro <a href="http://bluedogwebservices.com/wordpress-plugin/twitter-widget-pro/"><img src="images/link.png"></a></p>

            <pre>&lt;select name="<?php echo $this->get_field_name( 'items' ); ?>"&gt;
&lt;?php
    for ( $i = 1; $i <= 20; ++$i ) {
        echo "&lt;option value='$i' ";
        echo selected( $instance['items'], $i, false );
        echo "&gt;$i&lt;/option&gt;";
    }
?&gt;
&lt;/select&gt;</pre>

        </article>

        <article class="transition">
            <p>Gee...I would love a function that could tell me tell me what hook is currently running.</p>
        </article>

        <article>

            <h3>current_filter</h3>

            <h4>Purpose</h4>
            <p>Determine the currently running filter within a callback function</p>

			<h4>Args</h4>
			<ul>
				<li>none</li>
			</ul>

			<h4>Return</h4>
			<ul>
				<li>[string] name of the currently executing filter</li>
			</ul>

		</article>

        <article>

            <h3>current_filter</h3>

			<h4>Example</h4>

            <p>Alex Mills - Localtime <a href="http://wordpress.org/extend/plugins/localtime/"><img src="images/link.png"></a></p>

            <pre>public function add_html( $string, $format ) {
    switch ( current_filter() ) {
        case 'get_the_date':
        case 'get_comment_date':
            $format = get_option( 'date_format' );
            break;

        case 'get_post_time':
        case 'get_comment_time':
            $format = get_option( 'time_format' );
            break;

        default;
            return $string;
    }
}</pre>

		</article>

        <article>

            <h3>current_filter</h3>

			<h4>Example</h4>

            <p>Michael Fields - Taxonomy Images <a href="https://github.com/mfields/Taxonomy-Images"><img src="images/link.png"></a></p>

            <pre>function taxim_get_terms( $default, $args = array() ) {
    $filter = 'taxim-get-terms';

    if ( $filter !== current_filter() ) {
        taxim_please_use_filter( __FUNCTION__, $filter );
    }
}</pre>
            <p>current_action() also exists</p>

		</article>

        <article class="transition">
            <p>How can I tell if a function is executing in the loop or not?</p>
        </article>

        <article>

            <h3>in_the_loop</h3>

            <h4>Purpose</h4>
            <p>Determine if function is executing inside or outside of the loop</p>

            <h4>Args</h4>
            <ul>
                <li>none</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[bool] True if in loop; false if not</li>
            </ul>

        </article>

        <article>

            <h3>in_the_loop</h3>

            <h4>Example</h4>

            <p>Jon Bishop - Socialize <a href="http://www.jonbishop.com/2011/04/introducing-socialize-2-0-wordpress-plugin/"><img src="images/link.png"></a></p>

            <pre>add_filter( 'the_content', 'soc_insert_socialize' );
add_filter( 'the_excerpt', 'soc_insert_socialize' );

function soc_insert_socialize( $content ) {
    if ( in_the_loop() ) {
        // Magic
    }
    return $content;
}</pre>

        </article>

        <article class="transition">
            <p>I want to output the difference between times that is easy for humans to read.</p>
        </article>

        <article>

            <h3>human_time_diff</h3>

            <h4>Display a human readable time difference</h4>

            <h4>Args</h4>
            <ul>
                <li>$from [int] start of interval</li>
                <li>$to [int] end of interval; default = time()</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[string] human readable difference between $from and $to</li>
            </ul>

        </article>

        <article>

            <h3>human_time_diff</h3>

            <h4>Example</h4>

            <p>Zack Tollman/Helen Hou-Sand&iacute; - Debug Bar Cron <a href="http://wordpress.org/extend/plugins/debug-bar-cron/"><img src="images/link.png"></a></p>

            <pre>$time_next_cron = date( 'Y-m-d H:i:s', $unix_time_next_cron );
$human_time_next_cron = human_time_diff( $unix_time_next_cron );

echo '&lt;h2 class="times"&gt;&lt;span&gt;';
echo '__( 'Next Event', 'zt-debug-bar-cron' ) . ':&lt;/span&gt;';
echo $time_next_cron . '&lt;br /&gt;';
echo $unix_time_next_cron . '&lt;br /&gt;';
echo $human_time_next_cron . '&lt;/h2&gt;';</pre>

            <img src="images/different-time-views.png" />

        </article>

        <article class="transition">
            <p>Wouldn't it be cool to simply append a list of query variables to a URL?</p>
        </article>

        <article>

            <h3>add_query_arg</h3>

            <h4>Purpose</h4>
            <p>Append query variables and values to a URL</p>

            <h4>Args</h4>
            <ul>
                <li>$args [array] query var/value pairs</li>
                <li>$url [string] URL to append query vars to</li>
                <li>*none required</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[string] URL with query vars appended</li>
            </ul>

        </article>

        <article>

            <h3>add_query_arg</h3>

            <h4>Example</h4>

            <p>Pippin Williamson - Easy Digital Downloads <a href="http://easydigitaldownloads.com/"><img src="images/link.png"></a></p>

            <pre>function edd_get_download_url( $key, $email, $filekey, $download ) {
    $params = array(
        'download_key' => $key,
        'email' => urlencode( $email ),
        'file' => $filekey,
        'download' => $download,
        'expire' => strtotime( '+1 day', time() )
    );

    $download_url = add_query_arg( $params, home_url() );
    return $download_url;
}</pre>
            <!-- @todo: add example output -->

        </article>

        <article class="transition">
            <p>I want my theme to be able to intelligently load a template from a child theme before loading it from the parent theme.</p>
        </article>

        <article>

            <h3>locate_template</h3>

            <h4>Purpose</h4>
            <p>Requires a template from either a child or parent theme's folder</p>

            <h4>Args</h4>
            <ul>
                <li>$template_names [array|string] Template file(s) to search for</li>
                <li>$load [bool] True to load template; false to just return path</li>
                <li>$require_once [bool] True for require_once; false for require</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[string] path to file</li>
            </ul>

        </article>

        <article>

            <h3>locate_template</h3>

            <h4>Example</h4>

            <p>Modern Tribe - The Events Calendar <a href="http://tri.be/wordpress-events-calendar/"><img src="images/link.png"></a></p>

            <pre>public static function getTemplateHierarchy( $template ) {
    $tribe_ecp = TribeEvents::instance();

    if ( substr( $template, -4)  != '.php' )
        $template .= '.php';

    $templates = array( 'events/' . $template );

    if ( $theme_file = locate_template( $templates ) )
        $file = $theme_file;
    else
        $file = $tribe_ecp->pluginPath . 'views/' . $template;

    return apply_filters( 'tribe_events_template_' . $template, $file );
}</pre>

        </article>

        <article class="transition">
            <p>I want to include files only if my theme has support for a specific feature.</p>
        </article>

        <article>

            <h3>require_if_theme_supports</h3>

            <h4>Purpose</h4>

            <p>Requires a file if the theme supports a specified feature</p>

            <h4>Args</h4>
            <ul>
                <li>$feature [string] name of theme feature</li>
                <li>$include [string] path to required file</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>void</li>
            </ul>

        </article>

        <article>

            <h3>require_if_theme_supports</h3>

            <h4>Example</h4>

            <p>Justin Tadlock - Theme Hybrid Framework <a href="http://themehybrid.com/"><img src="images/link.png"></a></p>

            <pre>// In Parent
function extensions() {
    /* Load the Cleaner Caption extension if supported. */
    require_if_theme_supports(
        'cleaner-caption',
        trailingslashit( HYBRID_EXTENSIONS ) . 'cleaner-caption.php'
    );

    /* Load the Entry Views extension if supported. */
    require_if_theme_supports(
        'entry-views',
        trailingslashit( HYBRID_EXTENSIONS ) . 'entry-views.php'
    );
}

// In Child
add_theme_support( 'entry-views' );</pre>

        </article>

        <article class="transition">
            <p>Isn't there an easier way to get the ID of the current page's object.</p>
        </article>

        <article>

            <h3>get_queried_object_id</h3>

            <h4>Purpose</h4>

            <p>Gets the ID for the current page's main object</p>

            <h4>Args</h4>
            <ul>
                <li>none</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[integer] ID of the current $wp_the_query object</li>
            </ul>

            <h4>Related</h4>
            <ul>
                <li>get_queried_object</li>
            </ul>

        </article>

        <article>

            <h3>get_queried_object_id</h3>

            <h4>Example</h4>

            <p>Thorsten Ott - Nav Menu Cache <a href="http://hitchhackerguide.com/2011/10/07/caching-wordpress-navigation-menus-wp_nav_menu-wrapper/"><img src="images/link.png"></a></p>

            <pre>function hh_cached_nav_menu( $args = array(), $prime = false ) {
    if ( get_queried_object_id() )
        $qoi = get_queried_object_id();
    else
        $qoi = 0;

    $nav_menu_key = md5( serialize( $args ) . '-' . $qoi );

    if ( ! $nav_menu = get_transient( $nav_menu_key ) ) {
        ob_start();
        wp_nav_menu( $args );
        $nav_menu = ob_get_clean();
        set_transient( $nav_menu_key, $nav_menu );
    }

    return $nav_menu;
}</pre>

        </article>

        <article class="transition">
            <p>Can't it be easier to provide a list of default arguments for a functions arguments?</p>
        </article>

        <article>

            <h3>wp_parse_args</h3>

            <h4>Purpose</h4>
            <p>Guarantees certain indices in a an array are set by providing default values</p>

            <h4>Args</h4>
            <ul>
                <li>$args [string|array] value(s) to merge with $defaults</li>
                <li>$defaults [string|array] value(s) to merge with $args</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[array] merged value(s)</li>
            </ul>

        </article>

        <article>

            <h3>wp_parse_args</h3>

            <h4>Example</h4>

            <p>Otto - Simple Facebook Connect <a href="http://ottopress.com/wordpress-plugins/simple-facebook-connect/"><img src="images/link.png"></a></p>

            <pre>function get_sfc_activity_feed($args) {
    $args = wp_parse_args($args, array(
        'header'=>'true',
        'site'=>'',
        'bordercolor'=>'000000',
        'width'=>'260',
        'height'=>'400',
        'font'=>'lucida+grande',
        'colorscheme'=>'light',
        'recommendations'=>'false')
    );
    extract($args);

    return "&lt;fb:activity site='{$host}' {$path} width='{$width}' height='{$height}' header='{$header}' colorscheme='{$colorscheme}' font='{$font}' border_color='{$bordercolor}' recommendations='{$recommendations}'&gt;&lt;/fb:activity&gt;";
}</pre>

        </article>

        <article class="transition">
            <p>I need a way to impress my friends.</p>
        </article>

        <article>

            <h3>wp_list_pluck</h3>

            <h4>Purpose</h4>
            <p>Select a single index's value from a collection of similar objects/arrays</p>

            <h4>Args</h4>
            <ul>
                <li>$list [object|array] A list or array of objects</li>
                <li>$field [string|int] A field from $list to obtain</li>
            </ul>

            <h4>Return</h4>
            <ul>
                <li>[array] Single dimension array containing only the $field values from the child array|object within $list</li>
            </ul>

        </article>

		<article>

            <h3>wp_list_pluck</h3>

			<h4>Example</h4>
            <pre>
$posts = get_posts();
var_dump( $posts );</pre>

		</article>

		<article>

            <h3>wp_list_pluck</h3>

			<h4>Example</h4>
            <pre>
<b>array</b>
  0 <font color="#888a85">=&gt;</font>
    <b>object</b>(<i>stdClass</i>)[<i>81</i>]
      <i>public</i> 'ID' <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">801</font>
      <i>public</i> 'post_author' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'1'</font> <i>(length=1)</i>
      <i>public</i> 'post_date' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'2012-05-04 17:40:12'</font> <i>(length=19)</i>
        ...
  1 <font color="#888a85">=&gt;</font>
    <b>object</b>(<i>stdClass</i>)[<i>82</i>]
      <i>public</i> 'ID' <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">797</font>
      <i>public</i> 'post_author' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'2'</font> <i>(length=1)</i>
      <i>public</i> 'post_date' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'2012-05-04 17:39:30'</font> <i>(length=19)</i>
        ...
  2 <font color="#888a85">=&gt;</font>
    <b>object</b>(<i>stdClass</i>)[<i>83</i>]
      <i>public</i> 'ID' <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">784</font>
      <i>public</i> 'post_author' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'1'</font> <i>(length=1)</i>
      <i>public</i> 'post_date' <font color="#888a85">=&gt;</font> <small>string</small> <font color="#cc0000">'2012-04-29 01:22:08'</font> <i>(length=19)</i>
        ...</pre>

		</article>

		<article>

            <h3>wp_list_pluck</h3>

			<h4>Example</h4>
            <pre>
$posts = get_posts();
wp_list_pluck( $posts, 'ID' );</pre>

            <pre><b>array</b>
  0 <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">801</font>
  1 <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">797</font>
  2 <font color="#888a85">=&gt;</font> <small>int</small> <font color="#4e9a06">784</font></pre>

		</article>

		<article>

            <h3>wp_list_pluck</h3>

			<h4>Example</h4>

            <p>Scribus - Posts 2 Posts <a href="http://scribu.net/wordpress/posts-to-posts"><img src="images/link.png"></a></p>

            <pre>public function get_related( $post_id, $extra_qv = array() ) {
    $post_id = (array) $post_id;

    $connected = $this->get_connected( $post_id, $extra_qv );
    if ( !$connected )
        return false;

    if ( !$connected->have_posts() )
        return $connected;

    $connected_ids = wp_list_pluck( $connected->posts, 'ID' );

    return $this->get_connected( $connected_ids, array(
        'post__not_in' => $post_id,
    ) );
}</pre>

		</article>

        <article>
            <h2>In Conclusion</h2>
            <p>Use more Core functions</p>
            <p>Read more Core</p>

            <h3>Me</h3>
            <p>Zack Tollman</p>
            <p>@tollmanz</p>
            <p>tollmanz.com</p>
        </article>

	</section>

</body>
</html>